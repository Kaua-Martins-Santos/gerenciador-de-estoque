// prisma/schema.prisma

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

// === ITENS DE CONSUMO (GASTÁVEIS - PREGOS, FITA, ETC) ===
model ConsumableItem {
  id           String             @id @default(uuid())
  name         String
  category     String             // Elétrica, Hidráulica, etc.
  unit         String             // Un, Kg, M
  minQuantity  Int                @default(5)
  currentStock Int                @default(0)
  transactions StockTransaction[]
  createdAt    DateTime           @default(now())
}

model StockTransaction {
  id           String         @id @default(uuid())
  type         String         // IN, OUT
  quantity     Int
  date         DateTime       @default(now())
  reason       String?        
  department   String?        
  itemId       String
  item         ConsumableItem @relation(fields: [itemId], references: [id])
}

// === FERRAMENTAS / PATRIMÔNIO (FURADEIRAS, ESCADAS, ETC) ===
model PermanentItem {
  id           String   @id @default(uuid())
  name         String
  category     String   // Categoria (Ferramenta Manual, Elétrica...)
  quantity     Int      @default(1) // Quantidade total no estoque
  loans        Loan[]
  createdAt    DateTime @default(now())
}

// === EMPRÉSTIMOS (O QUE VAI NO PAPELZINHO) ===
model Loan {
  id             String        @id @default(uuid())
  borrowerName   String        // Quem pegou
  department     String        // Setor (Elétrica, Pintura...)
  loanDate       DateTime      @default(now())
  quantity       Int           @default(1)
  status         String        @default("EMPRESTADO") // EMPRESTADO, DEVOLVIDO
  itemId         String
  item           PermanentItem @relation(fields: [itemId], references: [id])
  returnDate     DateTime?     // Preenchido quando devolve no sistema
}

// === COMPRAS (IGUAL A PLANILHA ANTIGA) ===
model PurchaseRequest {
  id           String   @id @default(uuid())
  data         DateTime @default(now())
  solicitante  String
  departamento String
  descricao    String   // O item
  quantidade   String   // Texto (ex: "2 caixas")
  prioridade   String   // Baixa, Normal, Alta, Urgente
  status       String   @default("PENDENTE")
  observacao   String?
}